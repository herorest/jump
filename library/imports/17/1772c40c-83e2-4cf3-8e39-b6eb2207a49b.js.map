{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\game.js"],"names":["playerClass","require","blockClass","stageClass","cc","Class","extends","Component","properties","player","blockJs","stageManager","scoreLabel","Label","onLoad","setTouchStart","numScoreTotal","manager","director","getCollisionManager","enabled","update","node","on","Node","EventType","TOUCH_START","gameTouchStart","TOUCH_END","gameTouchEnd","disableTouch","targetOff","readyJump","e","onJump","jumpFinish","bind","pos","getWorldPlayerPos","currBlock","nextBlock","jumpCheck","success","failure","score","string","moveStage","console","log","setTimeout","resetGame","loadScene"],"mappings":";;;;;;AAAA,IAAIA,cAAcC,QAAQ,UAAR,CAAlB;AACA,IAAIC,aAAaD,QAAQ,SAAR,CAAjB;AACA,IAAIE,aAAaF,QAAQ,gBAAR,CAAjB;;AAEAG,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAQT,WADA;AAERU,iBAASR,UAFD;AAGRS,sBAAcR,UAHN;AAIRS,oBAAYR,GAAGS;AAJP,KAHP;;AAULC,UAVK,oBAUG;AACJ,aAAKC,aAAL;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,YAAIC,UAAUb,GAAGc,QAAH,CAAYC,mBAAZ,EAAd;AACAF,gBAAQG,OAAR,GAAkB,IAAlB;AACH,KAfI;AAiBLC,UAjBK,oBAiBG,CAEP,CAnBI;AAqBLN,iBArBK,2BAqBU;AACX,aAAKO,IAAL,CAAUC,EAAV,CAAanB,GAAGoB,IAAH,CAAQC,SAAR,CAAkBC,WAA/B,EAA4C,KAAKC,cAAjD,EAAiE,IAAjE;AACA,aAAKL,IAAL,CAAUC,EAAV,CAAanB,GAAGoB,IAAH,CAAQC,SAAR,CAAkBG,SAA/B,EAA0C,KAAKC,YAA/C,EAA6D,IAA7D;AACH,KAxBI;AA0BLC,gBA1BK,0BA0BS;AACV,aAAKR,IAAL,CAAUS,SAAV,CAAoB,IAApB;AACH,KA5BI;AA8BLJ,kBA9BK,4BA8BW;AACZ,aAAKlB,MAAL,CAAYuB,SAAZ;AACH,KAhCI;AAkCLH,gBAlCK,wBAkCQI,CAlCR,EAkCU;AACX;AACA;AACA,aAAKxB,MAAL,CAAYyB,MAAZ,CAAmB,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAnB;AACH,KAtCI;AAwCLD,cAxCK,wBAwCO;AACR,YAAIE,MAAM,KAAK5B,MAAL,CAAY6B,iBAAZ,EAAV;AACA,aAAK3B,YAAL,CAAkB4B,SAAlB,GAA8B,KAAK5B,YAAL,CAAkB6B,SAAhD;AACA,aAAK7B,YAAL,CAAkB4B,SAAlB,CAA4BE,SAA5B,CAAsCJ,GAAtC,EAA2C,KAAKK,OAAL,CAAaN,IAAb,CAAkB,IAAlB,CAA3C,EAAoE,KAAKO,OAAL,CAAaP,IAAb,CAAkB,IAAlB,CAApE;AACH,KA5CI;AA8CLM,WA9CK,mBA8CGE,KA9CH,EA8CS;AACV,aAAK5B,aAAL,IAAsB4B,KAAtB;AACA,aAAKhC,UAAL,CAAgBiC,MAAhB,GAAyB,UAAU,KAAK7B,aAAxC;AACA,aAAKL,YAAL,CAAkBmC,SAAlB;AACH,KAlDI;AAoDLH,WApDK,qBAoDI;AAAA;;AACL,aAAKb,YAAL;AACAiB,gBAAQC,GAAR,CAAY,SAAZ;;AAEAC,mBAAW,YAAM;AACb,kBAAKC,SAAL;AACH,SAFD,EAEE,IAFF;AAGH,KA3DI;AA6DLA,aA7DK,uBA6DM;AACP9C,WAAGc,QAAH,CAAYiC,SAAZ,CAAsB,MAAtB;AAEH;AAhEI,CAAT","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["let playerClass = require('./player');\r\nlet blockClass = require('./block');\r\nlet stageClass = require('./stageManager');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        player: playerClass,\r\n        blockJs: blockClass,\r\n        stageManager: stageClass,\r\n        scoreLabel: cc.Label\r\n    },\r\n\r\n    onLoad(){\r\n        this.setTouchStart();\r\n        this.numScoreTotal = 0;\r\n        let manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n    },\r\n\r\n    update(){\r\n\r\n    },\r\n\r\n    setTouchStart(){\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.gameTouchStart ,this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.gameTouchEnd ,this);\r\n    },\r\n\r\n    disableTouch(){\r\n        this.node.targetOff(this);\r\n    },\r\n\r\n    gameTouchStart(){\r\n        this.player.readyJump();\r\n    },\r\n\r\n    gameTouchEnd(e){\r\n        // let touches = e.getTouches();\r\n        // let touchLoc = touches[0].getLocation();\r\n        this.player.onJump(this.jumpFinish.bind(this));\r\n    },\r\n\r\n    jumpFinish(){\r\n        let pos = this.player.getWorldPlayerPos();\r\n        this.stageManager.currBlock = this.stageManager.nextBlock;\r\n        this.stageManager.currBlock.jumpCheck(pos, this.success.bind(this), this.failure.bind(this));\r\n    },\r\n\r\n    success(score){\r\n        this.numScoreTotal += score;\r\n        this.scoreLabel.string = '当前分数：' + this.numScoreTotal;\r\n        this.stageManager.moveStage();\r\n    },\r\n\r\n    failure(){\r\n        this.disableTouch();\r\n        console.log('failure');\r\n\r\n        setTimeout(() => {\r\n            this.resetGame();\r\n        },1000);\r\n    },\r\n\r\n    resetGame(){\r\n        cc.director.loadScene('main');\r\n\r\n    }\r\n});\r\n"]}